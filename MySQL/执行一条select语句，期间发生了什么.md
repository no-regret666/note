# 执行一条select语句，期间发生了什么

### 第一步：连接器

- 与客户端进行TCP三次握手建立连接
- 校验客户端的用户名和密码，如果用户名或密码不对，则会报错
- 如果用户名和密码都对了，会读取该用户的权限，然后后面的权限逻辑判断都基于此时读取到的逻辑

### 第二步：查询缓存

查询语句如果命中查询缓存则直接返回，否则继续往下执行。

（太鸡肋，MySQL 8.0版本之后已废除）

### 第三步：解析SQL

解析器进行词法分析、语法分析，语法没问题会构建出SQL语法树，方便后续模块读取表名、字段、语句类型，否则报错。

### 第四步：执行SQL

#### 预处理器

- 检查SQL查询语句中的表或者字段是否存在
- 将`select *`中的`*`符号，扩展为表上的所有列

#### 优化器

**主要负责将SQL查询语句的执行方案确定下来**。

#### 执行器

根据执行计划执行SQL查询语句，从存储引擎读取记录，返回给客户端；

- 主键索引
- 全表扫描
- 索引下推